<!-- Sidebar -->
<div id="mobile-more"
    class="fixed z-20 top-2 left-2 p-2 opacity-40 hover:opacity-100 cursor-pointer rounded-xl md:hidden">
    <i class="fa-solid fa-bars" onclick="showLogOutMobile()"></i>
</div>

<div id="mobile-logo" class="z-20 p-2 md fixed top-2 left-1/2 -translate-x-1/2 md:hidden">
    <a href="/">
        <i class="fa-brands fa-threads fa-2xl"></i>
    </a>
</div>

<nav
    class="fixed bottom-0 z-10 flex w-full h-20 text-center md:w-20 md:h-screen md:flex-col md:justify-between bg-lotion dark:bg-vampire-black">
    <div class="z-10 hidden transition duration-200 ease-in-out md:p-4 md:block hover:scale-110" id="pc-logo">
        <a href="/">
            <i class="fa-brands fa-threads fa-2xl"></i>
        </a>
    </div>

    <div class="flex items-center justify-around w-full md:flex-col md:gap-4">
        <a href="/">
            <div
                class="px-3 py-5 transition duration-200 ease-in-out sm:px-10 md:px-5 md:py-3 rounded-2xl hover:bg-anti-flash-white dark:hover:bg-chinese-black">
                <i
                    class="fa-solid fa-house fa-xl {{#if isHome}}text-black dark:text-cultured-active{{else}}text-philippine-silver dark:text-davy-grey{{/if}}"></i>
            </div>
        </a>

        <a href="/search">
            <div
                class="px-3 py-5 transition duration-200 ease-in-out cursor-pointer sm:px-10 md:px-5 md:py-3 rounded-2xl hover:bg-anti-flash-white dark:hover:bg-chinese-black">
                <i
                    class="fa-solid fa-magnifying-glass fa-xl {{#if isSearch}}text-black dark:text-cultured-active{{else}}text-philippine-silver dark:text-davy-grey{{/if}}"></i>
            </div>
        </a>

        <div class="hidden px-3 py-5 transition duration-200 ease-in-out cursor-pointer sm:px-10 md:px-5 md:py-3 rounded-2xl bg-anti-flash-white dark:bg-chinese-black dark:hover:bg-chinese-black md:block"
            onclick="createNewThread()">
            <i
                class="fa-solid fa-plus fa-xl text-philippine-silver hover:text-black dark:text-davy-grey dark:hover:text-cultured-active"></i>
        </div>

        <div class="px-3 py-5 transition duration-200 ease-in-out cursor-pointer sm:px-10 md:px-5 md:py-3 rounded-2xl hover:bg-anti-flash-white dark:hover:bg-chinese-black md:hidden"
            onclick="createNewThread()">
            <i class="fa-regular fa-pen-to-square fa-xl text-philippine-silver"></i>
        </div>

        <a href="/notifications">
            <div
                class="px-3 py-5 transition duration-200 ease-in-out sm:px-10 md:px-5 md:py-3 rounded-2xl hover:bg-anti-flash-white dark:hover:bg-chinese-black">
                <i
                    class="fa-regular fa-bell fa-xl {{#if isNoti}}text-black dark:text-cultured-active{{else}}text-philippine-silver dark:text-davy-grey{{/if}}"></i>
            </div>
        </a>

        <a href="/profile">
            <div
                class="px-3 py-5 transition duration-200 ease-in-out cursor-pointer sm:px-10 md:px-5 md:py-3 rounded-2xl hover:bg-anti-flash-white dark:hover:bg-chinese-black">
                <i
                    class="fa-regular fa-user fa-xl {{#if isProfile}}text-black dark:text-cultured-active{{else}}text-philippine-silver dark:text-davy-grey {{/if}}"></i>
            </div>
        </a>
    </div>

    <div id="more" class="hidden transition duration-200 ease-in-out cursor-pointer mb-9 rounded-2xl md:block">
        <i class="transition duration-75 ease-in-out fa-solid fa-bars fa-xl text-philippine-silver hover:text-black dark:text-davy-grey dark:hover:text-white"
            onclick="showLogOutPC()"></i>
    </div>
</nav>

<script>
    // Logout
    const showLogOutPC = () => {
        document.querySelectorAll('.logout-popup').forEach(popup => popup.remove());

        const popup = document.createElement('div');
        popup.classList.add('logout-popup', 'absolute', 'z-20', 'bg-white', 'border', 'rounded-xl', 'shadow-lg', 'py-2', 'pl-2', 'pr-2', 'dark:bg-eerie-black', 'dark:border-charleston-green', 'cursor-pointer');
        popup.style.top = `${document.getElementById('more').getBoundingClientRect().top - popup.offsetHeight - 20}px`;
        popup.style.left = `${document.getElementById('more').getBoundingClientRect().left + document.getElementById('more').offsetWidth}px`;

        const logoutButton = document.createElement('button');
        logoutButton.textContent = 'Log out';
        logoutButton.classList.add('bg-white', 'text-[#ff3042]', 'font-medium', 'pl-2', 'pr-10', 'py-2', 'rounded-xl', 'dark:bg-eerie-black', 'hover:bg-[#f5f5f5]');
        logoutButton.onclick = function () {
            window.location.href = '/logout';
        };

        popup.appendChild(logoutButton);
        document.body.appendChild(popup);

        document.addEventListener('click', function (e) {
            if (!popup.contains(e.target) && !document.getElementById('more').contains(e.target)) {
                popup.remove();
            }
        });
    }

    const showLogOutMobile = () => {
        document.querySelectorAll('.logout-popup').forEach(popup => popup.remove());

        const popup = document.createElement('div');
        popup.classList.add('logout-popup', 'absolute', 'top-12', 'left-0', 'z-20', 'bg-white', 'border', 'rounded-xl', 'shadow-lg', 'p-2', 'dark:bg-eerie-black', 'dark:border-charleston-green');

        const logoutButton = document.createElement('button');
        logoutButton.textContent = 'Log out';
        logoutButton.classList.add('bg-white', 'text-red-salsa', 'font-medium', 'px-4', 'py-2', 'rounded-xl', 'hover:bg-[#f5f5f5]', 'dark:bg-eerie-black');
        logoutButton.onclick = function () {
            window.location.href = '/logout';
        };

        popup.appendChild(logoutButton);
        document.body.appendChild(popup);

        document.addEventListener('click', function (e) {
            if (!popup.contains(e.target) && !document.getElementById('mobile-more').contains(e.target)) {
                popup.remove();
            }
        });
    }
</script>